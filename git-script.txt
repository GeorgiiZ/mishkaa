#!/bin/bash
function getCurBranch(){
    echo $(git branch | sed -n -e 's/^\* \(.*\)/\1/p')
}

branch=$(getCurBranch)

git stash push
git checkout $branch || git checkout -b $branch
git push || git push --set-upstream origin $branch
git stash apply
git config -f .gitmodules submodule.<submodule name>.branch $branch
git add .
git commit -m "Some changes to submodule"

